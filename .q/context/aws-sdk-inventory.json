{
  "analysis_date": "2025-09-12",
  "packages": [
    {
      "name": "amplify-util-mock",
      "path": "packages/amplify-util-mock",
      "migration_status": "v2_only",
      "priority": "high",
      "dependencies": {
        "aws-sdk": "^2.1113.0"
      },
      "devDependencies": {
        "aws-sdk": "^2.1113.0",
        "aws-sdk-mock": "^5.6.2"
      },
      "services_used": ["dynamodb"],
      "usage_patterns": [
        "DynamoDB client instantiation",
        "Promise-based API (.promise())",
        "Table operations (describeTable, listTables)",
        "Test utilities and mocking"
      ],
      "files_with_usage": [
        "src/utils/dynamo-db/helpers.ts",
        "src/utils/dynamo-db/utils.ts",
        "src/utils/dynamo-db/index.ts",
        "src/__tests__/utils/dynamo-db/*.test.ts",
        "src/__e2e__/subscriptions-with-auth.e2e.test.ts"
      ],
      "migration_complexity": "high",
      "notes": "Heavy DynamoDB usage, extensive test utilities"
    },
    {
      "name": "amplify-category-api",
      "path": "packages/amplify-category-api",
      "migration_status": "mixed",
      "priority": "high",
      "dependencies": {
        "aws-sdk": "^2.1113.0",
        "@aws-sdk/client-ec2": "3.624.0",
        "@aws-sdk/client-iam": "3.624.0",
        "@aws-sdk/client-lambda": "3.624.0"
      },
      "services_used": ["ec2", "iam", "lambda", "rds", "dynamodb"],
      "usage_patterns": ["Mixed v2/v3 usage", "VPC utilities already v3", "Container templates mixed", "Lambda functions mixed"],
      "files_with_usage": [
        "src/provider-utils/vpc-utils.ts (v3)",
        "src/provider-utils/awscloudformation/utils/rds-resources/ssmClient.ts",
        "resources/awscloudformation/lambdas/predeploy.js (v3)",
        "resources/awscloudformation/lambdas/pipeline.js (v3)",
        "resources/awscloudformation/container-templates/*/DynamoDBActions.js (v3)"
      ],
      "migration_complexity": "medium",
      "notes": "Partially migrated, need to complete remaining v2 usage"
    },
    {
      "name": "amplify-e2e-core",
      "path": "packages/amplify-e2e-core",
      "migration_status": "v3_complete",
      "priority": "none",
      "dependencies": {
        "@aws-sdk/client-ec2": "3.624.0",
        "@aws-sdk/client-kms": "3.624.0",
        "@aws-sdk/client-rds": "3.624.0",
        "@aws-sdk/client-rds-data": "3.624.0",
        "@aws-sdk/client-secrets-manager": "3.624.0",
        "@aws-sdk/client-ssm": "3.624.0",
        "@aws-sdk/client-sts": "3.624.0",
        "@aws-sdk/credential-providers": "3.624.0"
      },
      "services_used": ["ec2", "kms", "rds", "secrets-manager", "ssm", "sts"],
      "usage_patterns": ["Modern v3 patterns", "Command-based API", "Proper credential providers"],
      "migration_complexity": "none",
      "notes": "Already fully migrated to v3 - good reference implementation"
    },
    {
      "name": "amplify-dynamodb-simulator",
      "path": "packages/amplify-dynamodb-simulator",
      "migration_status": "v2_only",
      "priority": "medium",
      "dependencies": {
        "aws-sdk": "^2.1113.0"
      },
      "services_used": ["dynamodb"],
      "usage_patterns": ["DynamoDB simulator integration", "Local development utilities"],
      "migration_complexity": "medium",
      "notes": "Simulator package, may need coordination with simulator updates"
    },
    {
      "name": "amplify-e2e-tests",
      "path": "packages/amplify-e2e-tests",
      "migration_status": "v2_only",
      "priority": "medium",
      "dependencies": {
        "aws-sdk": "^2.1113.0"
      },
      "services_used": ["various"],
      "usage_patterns": ["E2E test utilities", "Integration testing"],
      "migration_complexity": "medium",
      "notes": "Test package, depends on amplify-e2e-core which is already v3"
    },
    {
      "name": "amplify-graphql-model-transformer",
      "path": "packages/amplify-graphql-model-transformer",
      "migration_status": "v3_complete",
      "priority": "none",
      "lambda_functions": ["rds-patching-lambda", "publish-notification-lambda", "rds-lambda"],
      "services_used": ["lambda", "sns", "ssm", "secrets-manager"],
      "usage_patterns": ["Lambda function dependencies", "Already using v3 SDK"],
      "migration_complexity": "none",
      "notes": "Lambda functions already use v3 SDK"
    },
    {
      "name": "graphql-relational-schema-transformer",
      "path": "packages/graphql-relational-schema-transformer",
      "migration_status": "unknown",
      "priority": "low",
      "migration_complexity": "low",
      "notes": "Need to investigate usage patterns"
    }
  ],
  "container_templates": [
    {
      "name": "dockerfile-rest-express",
      "path": "packages/amplify-category-api/resources/awscloudformation/container-templates/dockerfile-rest-express",
      "migration_status": "v3_complete",
      "services_used": ["dynamodb"],
      "notes": "Already uses @aws-sdk/lib-dynamodb and @aws-sdk/client-dynamodb"
    },
    {
      "name": "graphql-express",
      "path": "packages/amplify-category-api/resources/awscloudformation/container-templates/graphql-express",
      "migration_status": "v3_complete",
      "services_used": ["dynamodb"],
      "notes": "Already uses @aws-sdk/lib-dynamodb"
    },
    {
      "name": "dockercompose-rest-express",
      "path": "packages/amplify-category-api/resources/awscloudformation/container-templates/dockercompose-rest-express/express",
      "migration_status": "v3_complete",
      "services_used": ["dynamodb"],
      "notes": "Already uses @aws-sdk/lib-dynamodb"
    }
  ],
  "lambda_functions": [
    {
      "name": "predeploy.js",
      "path": "packages/amplify-category-api/resources/awscloudformation/lambdas/predeploy.js",
      "migration_status": "v3_complete",
      "services_used": ["codepipeline", "ecs"],
      "notes": "Already uses @aws-sdk/client-* packages"
    },
    {
      "name": "pipeline.js",
      "path": "packages/amplify-category-api/resources/awscloudformation/lambdas/pipeline.js",
      "migration_status": "v3_complete",
      "services_used": ["codepipeline", "ecs"],
      "notes": "Already uses @aws-sdk/client-* packages"
    }
  ],
  "summary": {
    "total_packages": 7,
    "v2_only": 3,
    "v3_complete": 3,
    "mixed": 1,
    "high_priority": 2,
    "medium_priority": 3,
    "low_priority": 1,
    "main_services": {
      "dynamodb": {
        "v2_usage": 3,
        "v3_usage": 4,
        "complexity": "high"
      },
      "ec2": {
        "v2_usage": 0,
        "v3_usage": 2,
        "complexity": "low"
      },
      "lambda": {
        "v2_usage": 0,
        "v3_usage": 3,
        "complexity": "low"
      },
      "rds": {
        "v2_usage": 0,
        "v3_usage": 2,
        "complexity": "low"
      }
    }
  },
  "migration_recommendations": {
    "phase_1": ["Complete amplify-category-api mixed usage", "Investigate remaining v2 usage in RDS resources"],
    "phase_2": ["Migrate amplify-util-mock (highest complexity)", "Update DynamoDB utilities and test patterns"],
    "phase_3": ["Migrate amplify-dynamodb-simulator", "Migrate amplify-e2e-tests", "Investigate graphql-relational-schema-transformer"],
    "phase_4": ["Remove aws-sdk v2 from root package.json resolutions", "Final cleanup and validation"]
  }
}
